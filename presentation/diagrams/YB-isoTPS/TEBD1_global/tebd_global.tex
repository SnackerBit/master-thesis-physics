\documentclass[crop,tikz,convert={outext=.svg,command=\unexpanded{pdf2svg \infile\space\outfile}},multi=false]{standalone}
\input{../../style.tex}
\begin{document}
	\def\tensorDistance{0.85*\defaultDistanceSmall}
	\def\physicalLegLength{\physicalLegLengthSmall}
	
	\def\coordinateSystemDistance{0.5*\tensorDistance}
	\def\ticklength{0.7*\defaultTextOffset}
	
	\def\verticalEquationDist{1.3*\tensorDistance}
	\def\equationPosX{-\coordinateSystemDistance+6*\tensorDistance+3.2*\defaultDistanceEquations/2}
	\def\equationPosY{2.5*\tensorDistance}
	
	\def\coordSystemAlpha{0.5}
	
	\colorlet{coordSystemColor}{black!20}
	
	\begin{tikzpicture}
		% Physical tensors
		\node[tensorPhysicalSmall] (T000) at (0, 0) {};
		\node[tensorPhysicalSmall] (T010) at (0, 2*\tensorDistance) {};
		\node[tensorPhysicalSmall] (T020) at (0, 4*\tensorDistance) {};
		
		\node[tensorPhysicalSmall] (T001) at (\tensorDistance, \tensorDistance) {};
		\node[tensorPhysicalSmall] (T011) at (\tensorDistance, 3*\tensorDistance) {};
		\node[tensorPhysicalSmall] (T021) at (\tensorDistance, 5*\tensorDistance) {};
		
		\node[tensorPhysicalSmall] (T100) at (2*\tensorDistance, 0) {};
		\node[tensorPhysicalSmall] (T110) at (2*\tensorDistance, 2*\tensorDistance) {};
		\node[tensorPhysicalSmall] (T120) at (2*\tensorDistance, 4*\tensorDistance) {};
		
		\node[tensorPhysicalSmall] (T101) at (3*\tensorDistance, \tensorDistance) {};
		\node[tensorPhysicalSmall] (T111) at (3*\tensorDistance, 3*\tensorDistance) {};
		\node[tensorPhysicalSmall] (T121) at (3*\tensorDistance, 5*\tensorDistance) {};
		
		\node[tensorPhysicalSmall] (T200) at (4*\tensorDistance, 0) {};
		\node[tensorPhysicalSmall] (T210) at (4*\tensorDistance, 2*\tensorDistance) {};
		\node[tensorPhysicalSmall] (T220) at (4*\tensorDistance, 4*\tensorDistance) {};
		
		\node[tensorPhysicalSmall] (T201) at (5*\tensorDistance, \tensorDistance) {};
		\node[tensorPhysicalSmall] (T211) at (5*\tensorDistance, 3*\tensorDistance) {};
		\node[tensorPhysicalSmall] (T221) at (5*\tensorDistance, 5*\tensorDistance) {};
		
		% Coordinate system
		\draw[thick, ->] (-\coordinateSystemDistance, -\coordinateSystemDistance) -- (-\coordinateSystemDistance+6*\tensorDistance, -\coordinateSystemDistance);
		\node[] () at (-\coordinateSystemDistance+6*\tensorDistance, -\coordinateSystemDistance-1.5*\defaultTextOffsetLarge-\ticklength/2) {$x$};
		\draw[thick, ->] (-\coordinateSystemDistance, -\coordinateSystemDistance) -- (-\coordinateSystemDistance, -\coordinateSystemDistance+6*\tensorDistance);
		\node[] () at (-\coordinateSystemDistance-1.5*\defaultTextOffsetLarge-\ticklength/2, -\coordinateSystemDistance+6*\tensorDistance) {$y$};
		% ticks
		\draw[thick] (\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2) -- ++(0, \ticklength);
		\draw[thick] (3*\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2) -- ++(0, \ticklength);
		\draw[thick] (5*\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2) -- ++(0, \ticklength);
		\draw[thick] (7*\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2) -- ++(0, \ticklength);
		\draw[thick] (9*\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2) -- ++(0, \ticklength);
		
		\draw[thick] (-\coordinateSystemDistance-\ticklength/2, \tensorDistance/2) -- ++(\ticklength, 0);
		\draw[thick] (-\coordinateSystemDistance-\ticklength/2, 3*\tensorDistance/2) -- ++(\ticklength, 0);
		\draw[thick] (-\coordinateSystemDistance-\ticklength/2, 5*\tensorDistance/2) -- ++(\ticklength, 0);
		\draw[thick] (-\coordinateSystemDistance-\ticklength/2, 7*\tensorDistance/2) -- ++(\ticklength, 0);
		\draw[thick] (-\coordinateSystemDistance-\ticklength/2, 9*\tensorDistance/2) -- ++(\ticklength, 0);
		% ticklabels
		\node[] () at (\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge) {$0$};
		\node[] () at (3*\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge) {$1$};
		\node[] () at (5*\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge) {$2$};
		\node[] () at (7*\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge) {$3$};
		\node[] () at (9*\tensorDistance/2, -\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge) {$4$};
		
		\node[] () at (-\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge, \tensorDistance/2) {$0$};
		\node[] () at (-\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge, 3*\tensorDistance/2) {$1$};
		\node[] () at (-\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge, 5*\tensorDistance/2) {$2$};
		\node[] () at (-\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge, 7*\tensorDistance/2) {$3$};
		\node[] () at (-\coordinateSystemDistance-\ticklength/2-\defaultTextOffsetLarge, 9*\tensorDistance/2) {$4$};
		
		\begin{pgfonlayer}{bg}
			\draw[coordSystemColor] (\tensorDistance/2, -\coordinateSystemDistance) -- ++(0, 5.5*\tensorDistance);
			\draw[coordSystemColor] (3*\tensorDistance/2, -\coordinateSystemDistance) -- ++(0, 5.5*\tensorDistance);
			\draw[coordSystemColor] (5*\tensorDistance/2, -\coordinateSystemDistance) -- ++(0, 5.5*\tensorDistance);
			\draw[coordSystemColor] (7*\tensorDistance/2, -\coordinateSystemDistance) -- ++(0, 5.5*\tensorDistance);
			\draw[coordSystemColor] (9*\tensorDistance/2, -\coordinateSystemDistance) -- ++(0, 5.5*\tensorDistance);
			
			\draw[coordSystemColor] (-\coordinateSystemDistance, \tensorDistance/2) -- ++(5.5*\tensorDistance, 0);
			\draw[coordSystemColor] (-\coordinateSystemDistance, 3*\tensorDistance/2) -- ++(5.5*\tensorDistance, 0);
			\draw[coordSystemColor] (-\coordinateSystemDistance, 5*\tensorDistance/2) -- ++(5.5*\tensorDistance, 0);
			\draw[coordSystemColor] (-\coordinateSystemDistance, 7*\tensorDistance/2) -- ++(5.5*\tensorDistance, 0);
			\draw[coordSystemColor] (-\coordinateSystemDistance, 9*\tensorDistance/2) -- ++(5.5*\tensorDistance, 0);
		\end{pgfonlayer}
		
		\begin{pgfonlayer}{bg}
			% virtual legs
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color1] (T000) -- (T001);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color1] (T010) -- (T011);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color1] (T020) -- (T021);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color1] (T100) -- (T101);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color1] (T110) -- (T111);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color1] (T120) -- (T121);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color1] (T201) -- (T200);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color1] (T211) -- (T210);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color1] (T221) -- (T220);
			
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color2] (T010) -- (T001);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color2] (T020) -- (T011);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color2] (T101) -- (T110);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color2] (T111) -- (T120);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color2] (T201) -- (T210);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color2] (T211) -- (T220);
			
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color3] (T001) -- (T100);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color3] (T011) -- (T110);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color3] (T021) -- (T120);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color3] (T200) -- (T101);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color3] (T210) -- (T111);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color3] (T220) -- (T121);
			
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color4] (T001) -- (T110);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color4] (T011) -- (T120);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color4] (T210) -- (T101);
			\draw[virtualLegSmallWithoutArrows, line width=\lineWidthHuge, draw=color4] (T220) -- (T111);
		\end{pgfonlayer}{bg}
	
		\node[] () at (\equationPosX, \equationPosY+1.5*\verticalEquationDist) {$\hat{H}_1 = \underset{\substack{x\text{ even}\\y\text{ even}}}{\sum} \textcolor{color1}{\hat{h}^{[x, y]}}$};
		\node[] () at (\equationPosX, \equationPosY+0.5*\verticalEquationDist) {$\hat{H}_2 = \underset{\substack{x\text{ even}\\y\text{ odd}}}{\sum} \textcolor{color2}{\hat{h}^{[x, y]}}$};
		\node[] () at (\equationPosX, \equationPosY-0.5*\verticalEquationDist) {$\hat{H}_3 = \underset{\substack{x\text{ odd}\\y\text{ even}}}{\sum} \textcolor{color3}{\hat{h}^{[x, y]}}$};
		\node[] () at (\equationPosX, \equationPosY-1.5*\verticalEquationDist) {$\hat{H}_4 = \underset{\substack{x\text{ odd}\\y\text{ odd}}}{\sum} \textcolor{color4}{\hat{h}^{[x, y]}}$};
	\end{tikzpicture}
\end{document}