% This file is used to globally define colors, line widths, etc. for diagrams used in the thesis
\usepackage[intlimits]{amsmath}
\usepackage{amssymb}
\usepackage{tikz}
\usepackage{ifthen}
\usepackage{tikz-network}
\let\Re\relax
\DeclareMathOperator{\Re}{Re}
\DeclareMathOperator{\Tr}{Tr}

% Libraries
\usetikzlibrary{decorations.markings}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}

% Basic colors
\definecolor{borderColor}{rgb}{0.0, 0.0, 0.0}
\definecolor{physicalTensorColor}{rgb}{0.0, 0.0, 0.0}
\definecolor{auxillaryTensorColor}{rgb}{1.0, 0.0, 0.0}
\definecolor{orthogonalityCenterColor}{rgb}{1.0, 0.616, 0.0}
\definecolor{physicalLegColor}{rgb}{0.5, 0.5, 0.5}
\definecolor{auxillaryLegColor}{rgb}{1.0, 0.0, 0.0}
\definecolor{virtualLegColor}{rgb}{0.0, 0.0, 0.0}
\definecolor{generalTensorColor}{rgb}{0.757, 0.827, 0.996}
\definecolor{identityColor}{rgb}{1.0, 1.0, 1.0}
\definecolor{redMarkingColor}{rgb}{1.0, 0.0, 0.0}
\definecolor{greenMarkingColor}{rgb}{0.1, 0.8, 0.1}
\definecolor{operatorColor}{rgb}{0.5, 1.0, 0.5}
\definecolor{specialLegColor}{HTML}{5d3fd3}
\definecolor{toricCodeSpinColor}{rgb}{1.0, 0.0, 0.0}
\definecolor{toricCodeEdgeSpinColor}{rgb}{0.0, 0.0, 0.7}
\definecolor{toricCodeAOperatorColor}{rgb}{0.0, 0.8, 0.0}
\definecolor{toricCodeBOperatorColor}{rgb}{0.0, 0.0, 1.0}
\definecolor{toricCodeDisoTPSTensorColor}{HTML}{5d3fd3}
\def \backgroundopacity {0.5}

\definecolor{color1}{HTML}{3182bd} % Same as 5blue4
\definecolor{color2}{HTML}{fd8d3c} % Same as 5orange3
\definecolor{color3}{HTML}{31a354} % Same as 5green4
\definecolor{color4}{HTML}{a50f15} % Same as 5red5

% Basic sizes
\def \defaultTensorWidth {19pt}
\def \smallTensorWidth {13pt}
\def \tinyTensorWidth {4pt}
\def \defaultLineWidth {2}
\def \lineWidthThick {2.5}
\def \lineWidthThin {1.8}
\def \lineWidthTiny {1.2}
\def \lineWidthHuge {4}
\def \xOffsetUnitCell {180pt}
\def \yOffsetUnitCell {180pt}
\def \yOffsetPhysicalLeg {30pt}
\def \physicalLegLength {30pt}
\def \physicalLegLengthSmall {15pt}
\def \defaultArrowscale {0.7}
\def \arrowScaleSmall {0.6}
\def \defaultArrowXShift {7pt}
\def \defaultDoubleArrowXShift {5pt}
\def \defaultTextOffset {6pt}
\def \defaultTextOffsetLarge {9pt}
\def \defaultTextOffsetSmall {1pt}
\def \defaultDistanceSmall {30pt}
\def \defaultDistanceSmallDiagonal {32pt}
\def \defaultDistanceNormal {40pt}
\def \defaultDistanceLarge {62 pt}
\def \defaultDistanceEquations {40pt}
\def \identityLegDistance {10 pt}
\def \isoTPSPhysicalLegAngle {30}
\def \defaultLegSeperationSmall{4pt}
\def \defaultLegSeperation{6.5pt}
\def \defaultLegSeperationLarge{9pt}
\def \roundedCornerInsetNormal{10pt}
\def \roundedCornerInsetSmall{2pt}
\def \braceWidth{10pt}
\def \physicalLegLengthSmallMPS{1.3*\physicalLegLengthSmall}


\def\tensorDistanceMPS{1.2*\defaultDistanceSmall}
\def\braketDistanceMPS{1.2*\defaultDistanceNormal}
\def\tensorWidthMPS{\smallTensorWidth}
\def\openLegMultiplierMPS{0.9}

% Tensor styles
\tikzstyle{tensorPhysical} = [circle, minimum size=\defaultTensorWidth, line width=\defaultLineWidth, fill=physicalTensorColor, draw=borderColor, outer sep=0]
\tikzstyle{tensorAuxillary} = [circle, minimum size=\defaultTensorWidth, line width=\defaultLineWidth, fill=auxillaryTensorColor, draw=borderColor, outer sep=0]
\tikzstyle{tensorOrthoCenter} = [circle, minimum size=\defaultTensorWidth, line width=\defaultLineWidth, fill=orthogonalityCenterColor, draw=borderColor, outer sep=0]

\tikzstyle{tensorPhysicalSmall} = [circle, minimum size=\smallTensorWidth, line width=\defaultLineWidth, fill=physicalTensorColor, draw=borderColor, outer sep=0]
\tikzstyle{tensorAuxillarySmall} = [circle, minimum size=\smallTensorWidth, line width=\defaultLineWidth, fill=auxillaryTensorColor, draw=borderColor, outer sep=0]
\tikzstyle{tensorOrthoCenterSmall} = [circle, minimum size=\smallTensorWidth, line width=\defaultLineWidth, fill=orthogonalityCenterColor, draw=borderColor, outer sep=0]

\tikzstyle{tensorOperator} = [rectangle, line width=\defaultLineWidth, fill=operatorColor, draw=borderColor, rounded corners=\roundedCornerInsetNormal]
\tikzstyle{tensorOperatorSmall} = [rectangle, line width=\defaultLineWidth, fill=operatorColor, draw=borderColor, rounded corners=\roundedCornerInsetSmall]

\tikzstyle{toricCodeSpin} = [circle, minimum size=\tinyTensorWidth, line width=\defaultLineWidth, fill=toricCodeSpinColor, draw=toricCodeSpinColor, inner sep=0, outer sep=0]
\tikzstyle{toricCodeEdgeSpin} = [circle, minimum size=\tinyTensorWidth, line width=\defaultLineWidth, fill=toricCodeEdgeSpinColor, draw=toricCodeEdgeSpinColor, inner sep=0, outer sep=0]
\tikzstyle{toricCodePEPSCenterTensor} = [circle, minimum size=2*\tinyTensorWidth, line width=\defaultLineWidth, fill=physicalTensorColor, draw=physicalTensorColor, inner sep=0, outer sep=0]
\tikzstyle{toricCodeDisoTPSTensor} = [circle, minimum size=0.9*\defaultTensorWidth, line width=\defaultLineWidth, fill=toricCodeDisoTPSTensorColor, draw=physicalTensorColor, inner sep=0, outer sep=0]

\tikzstyle{tensorPhysicalMPS} = [circle, minimum size=\smallTensorWidth, line width=\defaultLineWidth, fill=generalTensorColor, draw=borderColor, outer sep=0]
\tikzstyle{tensorPhysicalMPSCanonical} = [circle, minimum size=\smallTensorWidth, line width=\defaultLineWidth, fill=physicalTensorColor, draw=borderColor, outer sep=0]
\tikzstyle{tensorPhysicalMPSCanonicalOrthoCenter} = [circle, minimum size=\smallTensorWidth, line width=\defaultLineWidth, fill=orthogonalityCenterColor, draw=borderColor, outer sep=0]

% Leg styles
\tikzstyle{auxillaryLeg} = [color=auxillaryLegColor, line width=\defaultLineWidth, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\defaultArrowscale}\arrow[xshift=\defaultArrowXShift]{triangle 60}}}, postaction={decorate}]
\tikzstyle{physicalLeg} = [color=physicalLegColor, line width=\defaultLineWidth, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\defaultArrowscale}\arrow[xshift=\defaultArrowXShift]{triangle 60}}}, postaction={decorate}]
\tikzstyle{virtualLeg} = [color=virtualLegColor, line width=\defaultLineWidth, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\defaultArrowscale}\arrow[xshift=\defaultArrowXShift]{triangle 60}}}, postaction={decorate}]
\tikzstyle{specialLeg} = [color=specialLegColor, line width=\defaultLineWidth, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\defaultArrowscale}\arrow[xshift=\defaultArrowXShift]{triangle 60}}}, postaction={decorate}]

\tikzstyle{virtualLegLateArrows} = [color=virtualLegColor, line width=\defaultLineWidth, decoration={markings, mark=at position 0.8 with {\pgftransformscale{\defaultArrowscale}\arrow[xshift=\defaultArrowXShift]{triangle 60}}}, postaction={decorate}]
\tikzstyle{virtualLegWithoutArrows} = [color=virtualLegColor, line width=\defaultLineWidth]
\tikzstyle{physicalLegWithoutArrows} = [color=physicalLegColor, line width=\defaultLineWidth]
\tikzstyle{specialLegWithoutArrows} = [color=specialLegColor, line width=\defaultLineWidth]
\tikzstyle{virtualLegDoubleArrow} = [color=virtualLegColor, line width=\defaultLineWidth, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\defaultArrowscale}\arrow[xshift=\defaultDoubleArrowXShift]{Rays[round]}}}, postaction={decorate}]
\tikzstyle{auxillaryLegWithoutArrows} = [color=auxillaryLegColor, line width=\defaultLineWidth]

\tikzstyle{auxillaryLegSmall} = [color=auxillaryLegColor, line width=\lineWidthThin, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\arrowScaleSmall}\arrow[xshift=\defaultArrowXShift]{triangle 60}}}, postaction={decorate}]
\tikzstyle{auxillaryLegSmallWithoutArrows} = [color=auxillaryLegColor, line width=\lineWidthThin]
\tikzstyle{auxillaryLegSmallDoubleArrows} = [color=auxillaryLegColor, line width=\lineWidthThin, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\arrowScaleSmall}\arrow[xshift=\defaultDoubleArrowXShift]{Rays[round]}}}, postaction={decorate}]
\tikzstyle{physicalLegSmall} = [color=physicalLegColor, line width=\lineWidthThin, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\arrowScaleSmall}\arrow[xshift=\defaultArrowXShift]{triangle 60}}}, postaction={decorate}]
\tikzstyle{virtualLegSmall} = [color=virtualLegColor, line width=\lineWidthThin, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\arrowScaleSmall}\arrow[xshift=\defaultArrowXShift]{triangle 60}}}, postaction={decorate}]
\tikzstyle{virtualLegSmallWithoutArrows} = [color=virtualLegColor, line width=\lineWidthThin]
\tikzstyle{physicalLegSmallWithoutArrows} = [color=physicalLegColor, line width=\lineWidthThin]
\tikzstyle{virtualLegSmallDoubleArrows} = [color=virtualLegColor, line width=\lineWidthThin, decoration={markings, mark=at position 0.5 with {\pgftransformscale{\arrowScaleSmall}\arrow[xshift=\defaultDoubleArrowXShift]{Rays[round]}}}, postaction={decorate}]

% special symbols
\usepackage{amssymb}
\DeclareMathAlphabet{\mathbbb}{U}{bbold}{m}{n}
\newcommand{\id}{\mathbbb{1}}
\newcommand{\iu}{\mathrm{i}}% imaginary unit number i
\newcommand{\Stiefel}{\text{St}(n,p)}


% Layers
\pgfdeclarelayer{bg} % declare background layer
\pgfsetlayers{bg,main} % set order of layers

% Command for drawing convex hulls
\newcommand{\convexhull}[2]{
	[   
	create hullnodes/.code={
		\global\edef\namelist{#1}
		\foreach [count=\counter] \nodename in \namelist {
			\global\edef\numberofnodes{\counter}
			\node at (\nodename) [draw=none,name=hullnode\counter] {};
		}
		\node at (hullnode\numberofnodes) [name=hullnode0,draw=none] {};
		\pgfmathtruncatemacro\lastnumber{\numberofnodes+1}
		\node at (hullnode1) [name=hullnode\lastnumber,draw=none] {};
	},
	create hullnodes
	]
	($(hullnode1)!#2!-90:(hullnode0)$)
	\foreach [
	evaluate=\currentnode as \previousnode using \currentnode-1,
	evaluate=\currentnode as \nextnode using \currentnode+1
	] \currentnode in {1,...,\numberofnodes} {
		-- ($(hullnode\currentnode)!#2!-90:(hullnode\previousnode)$)
		let \p1 = ($(hullnode\currentnode)!#2!-90:(hullnode\previousnode) - (hullnode\currentnode)$),
		\n1 = {atan2(\y1,\x1)},
		\p2 = ($(hullnode\currentnode)!#2!90:(hullnode\nextnode) - (hullnode\currentnode)$),
		\n2 = {atan2(\y2,\x2)},
		\n{delta} = {-Mod(\n1-\n2,360)}
		in 
		{arc [start angle=\n1, delta angle=\n{delta}, radius=#2]}
	}
	-- cycle
}

% Command for drawing braces
%% https://tex.stackexchange.com/questions/55068/is-there-a-tikz-equivalent-to-the-pstricks-ncbar-command
\tikzset{
	ncbar angle/.initial=90,
	ncbar/.style={
		to path=(\tikztostart)
		-- ($(\tikztostart)!#1!\pgfkeysvalueof{/tikz/ncbar angle}:(\tikztotarget)$)
		-- ($(\tikztotarget)!($(\tikztostart)!#1!\pgfkeysvalueof{/tikz/ncbar angle}:(\tikztotarget)$)!\pgfkeysvalueof{/tikz/ncbar angle}:(\tikztostart)$)
		-- (\tikztotarget)
	},
	ncbar/.default=0.5cm,
}

\tikzset{square left brace/.style={ncbar=10pt}}
\tikzset{square right brace/.style={ncbar=-10pt}}

\tikzset{round left paren/.style={ncbar=10pt,out=120,in=-120}}
\tikzset{round right paren/.style={ncbar=10pt,out=60,in=-60}}