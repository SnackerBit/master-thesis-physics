\documentclass[crop, tikz]{standalone}
\input{../../style.tex}
\usepackage{tikz-network}

\begin{document}
	\def\openLegLength{21 pt}
	\def\tensorDistance{1.0*\defaultDistanceNormal}
	\def\ccdistance{70 pt}
	
	\def\posXNA{0}
	\def\posYNA{-\ccdistance/2}
	\def\posXNB{\tensorDistance*0.8}
	\def\posYNB{\tensorDistance*0.3-\ccdistance/2}
	\def\posXNC{\tensorDistance*0.5}
	\def\posYNC{-\tensorDistance*0.4-\ccdistance/2}
	\def\posXND{\tensorDistance*1.2}
	\def\posYND{-\tensorDistance*0.5-\ccdistance/2}
	\def\posXNE{\tensorDistance*1.8}
	\def\posYNE{-\tensorDistance*0.45-\ccdistance/2}
	\def\posXNF{\tensorDistance*1.5}
	\def\posYNF{\tensorDistance*0.4-\ccdistance/2}
	\def\posXNG{\tensorDistance*2.3}
	\def\posYNG{-\tensorDistance*0.1-\ccdistance/2}
	\def\posXNH{\tensorDistance*2.2}
	\def\posYNH{-\tensorDistance*0.8-\ccdistance/2}
	\def\posXNI{\tensorDistance*2.9}
	\def\posYNI{-\tensorDistance*0.2-\ccdistance/2}
	\def\posXNJ{\tensorDistance*3.1}
	\def\posYNJ{\tensorDistance*0.4-\ccdistance/2}
	
	\def\posXNpA{0}
	\def\posYNpA{\ccdistance/2}
	\def\posXNpB{\tensorDistance*0.8}
	\def\posYNpB{\tensorDistance*0.3+\ccdistance/2}
	\def\posXNpC{\tensorDistance*0.5}
	\def\posYNpC{-\tensorDistance*0.4+\ccdistance/2}
	\def\posXNpF{\tensorDistance*1.5}
	\def\posYNpF{\tensorDistance*0.4+\ccdistance/2}
	\def\posXNpG{\tensorDistance*2.3}
	\def\posYNpG{-\tensorDistance*0.1+\ccdistance/2}
	\def\posXNpH{\tensorDistance*2.2}
	\def\posYNpH{-\tensorDistance*0.8+\ccdistance/2}
	\def\posXNpI{\tensorDistance*2.9}
	\def\posYNpI{-\tensorDistance*0.2+\ccdistance/2}
	\def\posXNpJ{\tensorDistance*3.1}
	\def\posYNpJ{\tensorDistance*0.4+\ccdistance/2}
	\def\posXNpK{\tensorDistance*1.1}
	\def\posYNpK{-\tensorDistance*0.55+\ccdistance/2}
	\def\posXNpL{\tensorDistance*1.7}
	\def\posYNpL{-\tensorDistance*0.6+\ccdistance/2}
	\def\posXNpM{\tensorDistance*1.45}
	\def\posYNpM{-\tensorDistance*0.15+\ccdistance/2}
	
	\def\angleA{170}
	\def\angleC{-120}
	\def\angleF{35}
	\def\angleH{-45}
	\def\angleI{-10}
	\def\angleJ{20}
	
	\begin{tikzpicture}
		% Draw beginning of equation and first equal sign
		\node[] () at ({\posXNA+\openLegLength*cos(\angleA)-\defaultDistanceEquations/2+7pt}, 0) {$=$};
		\node[] () at ({\posXNA+\openLegLength*cos(\angleA)-\defaultDistanceEquations-5pt}, 0) {$\langle\mathcal{N},\mathcal{N}^\prime\rangle_\text{F}$};
		
		% Draw tensors of N
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NA) at (\posXNA, \posYNA) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NB) at (\posXNB, \posYNB) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NC) at (\posXNC, \posYNC) {};
		\node[tensorOrthoCenter, minimum size=\smallTensorWidth] (ND) at (\posXND, \posYND) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth, fill=redMarkingColor] (NE) at (\posXNE, \posYNE) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NF) at (\posXNF, \posYNF) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NG) at (\posXNG, \posYNG) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NH) at (\posXNH, \posYNH) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NI) at (\posXNI, \posYNI) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NJ) at (\posXNJ, \posYNJ) {};
		
		\begin{pgfonlayer}{bg}
			% Draw subregion M
			%\fill[fill=redMarkingColor, opacity=\backgroundopacity] \convexhull{D, E}{\smallTensorWidth*0.9};
			%\node[color=redMarkingColor] (M) at (\posXND-\tensorDistance*0.2, \posYND-\tensorDistance*0.4) {$\mathcal{M}$};
			
			% Draw connecting legs
			\draw[virtualLeg] (NA) -- (NB);
			\draw[virtualLeg] (NB) -- (NF);
			\draw[virtualLeg] (NC) -- (NB);
			\draw[virtualLeg] (NC) -- (ND);
			\draw[virtualLeg] (NE) -- (ND);
			\draw[virtualLeg] (NF) -- (NG);
			\draw[virtualLeg] (NF) -- (NE);
			\draw[virtualLeg] (NG) -- (NH);
			\draw[virtualLeg] (NH) -- (NE);
			\draw[virtualLeg] (NI) -- (NJ);
			\draw[virtualLeg] (NI) -- (NG);
			\draw[virtualLeg] (NJ) -- (NG);
			
			\draw[virtualLeg] ({\posXNA+\openLegLength*cos(\angleA)}, {\posYNA+\openLegLength*sin(\angleA)}) -- (NA);
			\draw[virtualLeg] ({\posXNC+\openLegLength*cos(\angleC)}, {\posYNC+\openLegLength*sin(\angleC)}) -- (NC);
			\draw[virtualLeg] ({\posXNF+\openLegLength*cos(\angleF)}, {\posYNF+\openLegLength*sin(\angleF)}) -- (NF);
			\draw[virtualLeg] ({\posXNH+\openLegLength*cos(\angleH)}, {\posYNH+\openLegLength*sin(\angleH)}) -- (NH);
			\draw[virtualLeg] ({\posXNI+\openLegLength*cos(\angleI)}, {\posYNI+\openLegLength*sin(\angleI)}) -- (NI);
			\draw[virtualLeg] ({\posXNJ+\openLegLength*cos(\angleJ)}, {\posYNJ+\openLegLength*sin(\angleJ)}) -- (NJ);
		\end{pgfonlayer}
		
		% Draw tensors of N'
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpA) at (\posXNpA, \posYNpA) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpB) at (\posXNpB, \posYNpB) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpC) at (\posXNpC, \posYNpC) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpF) at (\posXNpF, \posYNpF) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpG) at (\posXNpG, \posYNpG) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpH) at (\posXNpH, \posYNpH) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpI) at (\posXNpI, \posYNpI) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpJ) at (\posXNpJ, \posYNpJ) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth, fill=greenMarkingColor] (NpK) at (\posXNpK, \posYNpK) {};
		\node[tensorOrthoCenter, minimum size=\smallTensorWidth] (NpL) at (\posXNpL, \posYNpL) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth, fill=greenMarkingColor] (NpM) at (\posXNpM, \posYNpM) {};
		
		\begin{pgfonlayer}{bg}
			% Draw subregion M
			%\fill[color=greenMarkingColor, opacity=\backgroundopacity] \convexhull{K, M, L}{\smallTensorWidth*0.9};
			%\node[color=greenMarkingColor] (Mp) at (\posXNpK-\tensorDistance*0.2, \posYNpK-\tensorDistance*0.4) {$\mathcal{M}^\prime$};
			
			% Draw connecting legs
			\draw[virtualLeg] (NpA) -- (NpB);
			\draw[virtualLeg] (NpB) -- (NpF);
			\draw[virtualLeg] (NpC) -- (NpB);
			\draw[virtualLeg] (NpC) -- (NpK);
			\draw[virtualLeg] (NpF) -- (NpG);
			\draw[virtualLeg] (NpF) -- (NpM);
			\draw[virtualLeg] (NpG) -- (NpH);
			\draw[virtualLeg] (NpH) -- (NpL);
			\draw[virtualLeg] (NpI) -- (NpJ);
			\draw[virtualLeg] (NpI) -- (NpG);
			\draw[virtualLeg] (NpJ) -- (NpG);
			\draw[virtualLeg] (NpK) -- (NpL);
			\draw[virtualLeg] (NpK) -- (NpM);
			\draw[virtualLeg] (NpM) -- (NpL);
			
			\draw[virtualLeg] ({\posXNpA+\openLegLength*cos(\angleA)}, {\posYNpA+\openLegLength*sin(\angleA)}) -- (NpA);
			\draw[virtualLeg] ({\posXNpC+\openLegLength*cos(\angleC)}, {\posYNpC+\openLegLength*sin(\angleC)}) -- (NpC);
			\draw[virtualLeg] ({\posXNpF+\openLegLength*cos(\angleF)}, {\posYNpF+\openLegLength*sin(\angleF)}) -- (NpF);
			\draw[virtualLeg] ({\posXNpH+\openLegLength*cos(\angleH)}, {\posYNpH+\openLegLength*sin(\angleH)}) -- (NpH);
			\draw[virtualLeg] ({\posXNpI+\openLegLength*cos(\angleI)}, {\posYNpI+\openLegLength*sin(\angleI)}) -- (NpI);
			\draw[virtualLeg] ({\posXNpJ+\openLegLength*cos(\angleJ)}, {\posYNpJ+\openLegLength*sin(\angleJ)}) -- (NpJ);
		\end{pgfonlayer}
		
		% Draw connections of upper/lower wavefunction
		\begin{pgfonlayer}{bg}
			\draw[virtualLegWithoutArrows] (NpA) -- ++({\openLegLength*cos(\angleA)}, {\openLegLength*sin(\angleA)}) -- ++(0, -\ccdistance) -- (NA);
			\draw[virtualLegWithoutArrows] (NpF) -- ++({\openLegLength*cos(\angleF)}, {\openLegLength*sin(\angleF)}) -- ++(0, -\ccdistance) -- (NF);
			\draw[virtualLegWithoutArrows] (NpH) -- ++({\openLegLength*cos(\angleH)}, {\openLegLength*sin(\angleH)}) -- ++(0, -\ccdistance) -- (NH);
			\draw[virtualLegWithoutArrows] (NpI) -- ++({\openLegLength*cos(\angleI)}, {\openLegLength*sin(\angleI)}) -- ++(0, -\ccdistance) -- (NI);
			\draw[virtualLegWithoutArrows] (NpJ) -- ++({\openLegLength*cos(\angleJ)}, {\openLegLength*sin(\angleJ)}) -- ++(0, -\ccdistance) -- (NJ);
		\end{pgfonlayer}
		\draw[virtualLegWithoutArrows] (NpC) -- ++({\openLegLength*cos(\angleC)}, {\openLegLength*sin(\angleC)}) -- ++(0, -\ccdistance) -- (NC);
		
		% Draw second equal sign
		\node[] () at ({\posXNI+\openLegLength*cos(\angleI)+\defaultDistanceEquations/2}, 0) {$=$};
		
		\def\xoffset{158pt}
		
		\def\posXNA{0 + \xoffset}
		\def\posYNA{-\ccdistance/2}
		\def\posXNB{\tensorDistance*0.8 + \xoffset}
		\def\posYNB{\tensorDistance*0.3-\ccdistance/2}
		\def\posXNC{\tensorDistance*0.5 + \xoffset}
		\def\posYNC{-\tensorDistance*0.4-\ccdistance/2}
		\def\posXND{\tensorDistance*1.2 + \xoffset}
		\def\posYND{-\tensorDistance*0.5-\ccdistance/2}
		\def\posXNE{\tensorDistance*1.8 + \xoffset}
		\def\posYNE{-\tensorDistance*0.45-\ccdistance/2}
		\def\posXNF{\tensorDistance*1.5 + \xoffset}
		\def\posYNF{\tensorDistance*0.4-\ccdistance/2}
		\def\posXNG{\tensorDistance*2.3 + \xoffset}
		\def\posYNG{-\tensorDistance*0.1-\ccdistance/2}
		\def\posXNH{\tensorDistance*2.2 + \xoffset}
		\def\posYNH{-\tensorDistance*0.8-\ccdistance/2}
		\def\posXNI{\tensorDistance*2.9 + \xoffset}
		\def\posYNI{-\tensorDistance*0.3-\ccdistance/2}
		\def\posXNJ{\tensorDistance*3.1 + \xoffset}
		\def\posYNJ{\tensorDistance*0.4-\ccdistance/2}
		
		\def\posXNpA{0}
		\def\posYNpA{\ccdistance/2}
		\def\posXNpB{\tensorDistance*0.8 + \xoffset}
		\def\posYNpB{\tensorDistance*0.3+\ccdistance/2}
		\def\posXNpC{\tensorDistance*0.5 + \xoffset}
		\def\posYNpC{-\tensorDistance*0.4+\ccdistance/2}
		\def\posXNpF{\tensorDistance*1.5 + \xoffset}
		\def\posYNpF{\tensorDistance*0.4+\ccdistance/2}
		\def\posXNpG{\tensorDistance*2.3 + \xoffset}
		\def\posYNpG{-\tensorDistance*0.1+\ccdistance/2}
		\def\posXNpH{\tensorDistance*2.2 + \xoffset}
		\def\posYNpH{-\tensorDistance*0.8+\ccdistance/2}
		\def\posXNpI{\tensorDistance*2.9 + \xoffset}
		\def\posYNpI{-\tensorDistance*0.3+\ccdistance/2}
		\def\posXNpJ{\tensorDistance*3.1 + \xoffset}
		\def\posYNpJ{\tensorDistance*0.4+\ccdistance/2}
		\def\posXNpK{\tensorDistance*1.1 + \xoffset}
		\def\posYNpK{-\tensorDistance*0.55+\ccdistance/2}
		\def\posXNpL{\tensorDistance*1.7 + \xoffset}
		\def\posYNpL{-\tensorDistance*0.6+\ccdistance/2}
		\def\posXNpM{\tensorDistance*1.45 + \xoffset}
		\def\posYNpM{-\tensorDistance*0.15+\ccdistance/2}
		
		% Draw tensors of N
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NB) at (\posXNB, \posYNB) {};
		\node[tensorOrthoCenter, minimum size=\smallTensorWidth] (ND) at (\posXND, \posYND) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth, fill=redMarkingColor] (NE) at (\posXNE, \posYNE) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NF) at (\posXNF, \posYNF) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NG) at (\posXNG, \posYNG) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NH) at (\posXNH, \posYNH) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NJ) at (\posXNJ, \posYNJ) {};
		
		\def\angleBa{(-180)}
		\def\angleBb{(-140)}
		\def\angleD{(180-atan(1/7))}
		\def\angleG{(-atan(1/8))}
		\def\angleJb{(-50)}
		\def\angleK{(180-atan(15/60))}
		
		\begin{pgfonlayer}{bg}
			% Draw subregion M
			%\fill[fill=redMarkingColor, opacity=\backgroundopacity] \convexhull{D, E}{\smallTensorWidth*0.9};
			%\node[color=redMarkingColor] (M) at (\posXND-\tensorDistance*0.2, \posYND-\tensorDistance*0.4) {$\mathcal{M}$};
			
			% Draw connecting legs
			\draw[virtualLeg] (NB) -- (NF);
			\draw[virtualLeg] (NE) -- (ND);
			\draw[virtualLeg] (NF) -- (NG);
			\draw[virtualLeg] (NF) -- (NE);
			\draw[virtualLeg] (NG) -- (NH);
			\draw[virtualLeg] (NH) -- (NE);
			\draw[virtualLeg] (NJ) -- (NG);
			
			\draw[virtualLeg] ({\posXNF+\openLegLength*cos(\angleF)}, {\posYNF+\openLegLength*sin(\angleF)}) -- (NF);
			\draw[virtualLeg] ({\posXNH+\openLegLength*cos(\angleH)}, {\posYNH+\openLegLength*sin(\angleH)}) -- (NH);
			\draw[virtualLeg] ({\posXNJ+\openLegLength*cos(\angleJ)}, {\posYNJ+\openLegLength*sin(\angleJ)}) -- (NJ);
			
			\draw[virtualLeg] ({\posXNB+\openLegLength*cos(\angleBa)}, {\posYNB+\openLegLength*sin(\angleBa)}) -- (NB);
			\draw[virtualLeg] ({\posXNB+\openLegLength*cos(\angleBb)}, {\posYNB+\openLegLength*sin(\angleBb)}) -- (NB);
			%\draw[virtualLeg] ({\posXND+\openLegLength*cos(\angleD)}, {\posYND+\openLegLength*sin(\angleD)}) -- (ND); 
			\draw[virtualLeg] ({\posXNpK+\openLegLength*cos(\angleK)}, {\posYNpK+\openLegLength*sin(\angleK)-\ccdistance}) -- (ND); % Draw now with different angle for better visual clarity!
			\draw[virtualLeg] ({\posXNG+\openLegLength*cos(\angleG)}, {\posYNG+\openLegLength*sin(\angleG)}) -- (NG);
			\draw[virtualLeg] ({\posXNJ+\openLegLength*cos(\angleJb)}, {\posYNJ+\openLegLength*sin(\angleJb)}) -- (NJ);
		\end{pgfonlayer}
		
		% Draw tensors of N'
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpB) at (\posXNpB, \posYNpB) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpF) at (\posXNpF, \posYNpF) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpG) at (\posXNpG, \posYNpG) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpH) at (\posXNpH, \posYNpH) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth] (NpJ) at (\posXNpJ, \posYNpJ) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth, fill=greenMarkingColor] (NpK) at (\posXNpK, \posYNpK) {};
		\node[tensorOrthoCenter, minimum size=\smallTensorWidth] (NpL) at (\posXNpL, \posYNpL) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth, fill=greenMarkingColor] (NpM) at (\posXNpM, \posYNpM) {};
		
		\begin{pgfonlayer}{bg}
			% Draw subregion M
			%\fill[color=greenMarkingColor, opacity=\backgroundopacity] \convexhull{K, M, L}{\smallTensorWidth*0.9};
			%\node[color=greenMarkingColor] (Mp) at (\posXNpK-\tensorDistance*0.2, \posYNpK-\tensorDistance*0.4) {$\mathcal{M}^\prime$};
			
			% Draw connecting legs
			\draw[virtualLeg] (NpB) -- (NpF);
			\draw[virtualLeg] (NpF) -- (NpG);
			\draw[virtualLeg] (NpF) -- (NpM);
			\draw[virtualLeg] (NpG) -- (NpH);
			\draw[virtualLeg] (NpH) -- (NpL);
			\draw[virtualLeg] (NpJ) -- (NpG);
			\draw[virtualLeg] (NpK) -- (NpL);
			\draw[virtualLeg] (NpK) -- (NpM);
			\draw[virtualLeg] (NpM) -- (NpL);
			
			\draw[virtualLeg] ({\posXNpF+\openLegLength*cos(\angleF)}, {\posYNpF+\openLegLength*sin(\angleF)}) -- (NpF);
			\draw[virtualLeg] ({\posXNpH+\openLegLength*cos(\angleH)}, {\posYNpH+\openLegLength*sin(\angleH)}) -- (NpH);
			\draw[virtualLeg] ({\posXNpJ+\openLegLength*cos(\angleJ)}, {\posYNpJ+\openLegLength*sin(\angleJ)}) -- (NpJ);
			
			\draw[virtualLeg] ({\posXNpB+\openLegLength*cos(\angleBa)}, {\posYNpB+\openLegLength*sin(\angleBa)}) -- (NpB);
			\draw[virtualLeg] ({\posXNpB+\openLegLength*cos(\angleBb)}, {\posYNpB+\openLegLength*sin(\angleBb)}) -- (NpB);
			\draw[virtualLeg] ({\posXNpK+\openLegLength*cos(\angleK)}, {\posYNpK+\openLegLength*sin(\angleK)}) -- (NpK);
			\draw[virtualLeg] ({\posXNpG+\openLegLength*cos(\angleG)}, {\posYNpG+\openLegLength*sin(\angleG)}) -- (NpG);
			\draw[virtualLeg] ({\posXNpJ+\openLegLength*cos(\angleJb)}, {\posYNpJ+\openLegLength*sin(\angleJb)}) -- (NpJ);
		\end{pgfonlayer}
		
		% Draw connections of upper/lower wavefunction
		\begin{pgfonlayer}{bg}
			\draw[virtualLegWithoutArrows] (NpF) -- ++({\openLegLength*cos(\angleF)}, {\openLegLength*sin(\angleF)}) -- ++(0, -\ccdistance) -- (NF);
			\draw[virtualLegWithoutArrows] (NpH) -- ++({\openLegLength*cos(\angleH)}, {\openLegLength*sin(\angleH)}) -- ++(0, -\ccdistance) -- (NH);
			\draw[virtualLegWithoutArrows] (NpJ) -- ++({\openLegLength*cos(\angleJ)}, {\openLegLength*sin(\angleJ)}) -- ++(0, -\ccdistance) -- (NJ);
			
			\draw[virtualLegWithoutArrows] (NpB) -- ++({\openLegLength*cos(\angleBa)}, {\openLegLength*sin(\angleBa)}) -- ++(0, -\ccdistance) -- (NB);
			\draw[virtualLegWithoutArrows] (NpB) -- ++({\openLegLength*cos(\angleBb)}, {\openLegLength*sin(\angleBb)}) -- ++(0, -\ccdistance) -- (NB);
			\draw[virtualLegWithoutArrows] (NpK) -- ++({\openLegLength*cos(\angleK)}, {\openLegLength*sin(\angleK)}) -- ++(0, -\ccdistance) -- (ND);
			
			\draw[virtualLegWithoutArrows] (NpG) -- ++({\openLegLength*cos(\angleG)}, {\openLegLength*sin(\angleG)})  -- ++(0, -\ccdistance)-- (NG);
			\draw[virtualLegWithoutArrows] (NpJ) -- ++({\openLegLength*cos(\angleJb)}, {\openLegLength*sin(\angleJb)})  -- ++(0, -\ccdistance)-- (NJ);
		\end{pgfonlayer}
		
		% Draw third equal sign
		\def\yoffset{-140pt}
		\def\xoffset{70pt}
		\node[] () at (\xoffset, \yoffset) {$=$};
		\node[] () at (\xoffset + \defaultDistanceEquations/2, \yoffset) {$\dots$};
		\node[] () at (\xoffset + \defaultDistanceEquations, \yoffset) {$=$};
		
		\def\additionalxoffset{25 pt}
		\def\additionalyoffset{25 pt}
		\def\ccdistance{50 pt}
		
		\def\posXND{\tensorDistance*1.2 + \xoffset + \additionalxoffset}
		\def\posYND{-\tensorDistance*0.5-\ccdistance/2 + \yoffset + \additionalyoffset}
		\def\posXNE{\tensorDistance*1.8 + \xoffset + \additionalxoffset}
		\def\posYNE{-\tensorDistance*0.45-\ccdistance/2 + \yoffset + \additionalyoffset}
		
		\def\posXNpK{\tensorDistance*1.2 + \xoffset + \additionalxoffset}
		\def\posYNpK{-\tensorDistance*0.55+\ccdistance/2 + \yoffset + \additionalyoffset}
		\def\posXNpL{\tensorDistance*1.8 + \xoffset + \additionalxoffset}
		\def\posYNpL{-\tensorDistance*0.6+\ccdistance/2 + \yoffset + \additionalyoffset}
		\def\posXNpM{\tensorDistance*1.55 + \xoffset + \additionalxoffset}
		\def\posYNpM{-\tensorDistance*0.15+\ccdistance/2 + \yoffset + \additionalyoffset}
		
		% Draw tensors of N
		\node[tensorOrthoCenter, minimum size=\smallTensorWidth] (ND) at (\posXND, \posYND) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth, fill=redMarkingColor] (NE) at (\posXNE, \posYNE) {};
		
		\draw[virtualLeg] (NE) -- (ND);
		
		% Draw tensors of N'
		\node[tensorPhysical, minimum size=\smallTensorWidth, fill=greenMarkingColor] (NpK) at (\posXNpK, \posYNpK) {};
		\node[tensorOrthoCenter, minimum size=\smallTensorWidth] (NpL) at (\posXNpL, \posYNpL) {};
		\node[tensorPhysical, minimum size=\smallTensorWidth, fill=greenMarkingColor] (NpM) at (\posXNpM, \posYNpM) {};
		
		\draw[virtualLeg] (NpK) -- (NpL);
		\draw[virtualLeg] (NpM) -- (NpL);
		\draw[virtualLeg] (NpK) -- (NpM);
		
		\def\angleEa{60}
		\def\angleEb{-30}
		\def\angleD{-140}
		
		\def\angleK{-140}
		\def\angleL{-20}
		\def\angleM{30}
		
		\draw[virtualLeg] ({\posXNE+\openLegLength*cos(\angleEa)}, {\posYNE+\openLegLength*sin(\angleEa)}) -- (NE);
		\draw[virtualLeg] ({\posXNE+\openLegLength*cos(\angleEb)}, {\posYNE+\openLegLength*sin(\angleEb)}) -- (NE);
		\draw[virtualLeg] ({\posXND+\openLegLength*cos(\angleD)}, {\posYND+\openLegLength*sin(\angleD)}) -- (ND);
		\draw[virtualLeg] ({\posXNpK+\openLegLength*cos(\angleK)}, {\posYNpK+\openLegLength*sin(\angleK)}) -- (NpK);
		\draw[virtualLeg] ({\posXNpL+\openLegLength*cos(\angleL)}, {\posYNpL+\openLegLength*sin(\angleL)}) -- (NpL);
		\draw[virtualLeg] ({\posXNpM+\openLegLength*cos(\angleM)}, {\posYNpM+\openLegLength*sin(\angleM)}) -- (NpM);
		
		\draw[virtualLegWithoutArrows] (NpK) -- ++({\openLegLength*cos(\angleK)}, {\openLegLength*sin(\angleK)}) -- ({\posXND+\openLegLength*cos(\angleD)}, {\posYND+\openLegLength*sin(\angleD)}) -- (ND);
		\draw[virtualLegWithoutArrows] (NpM) -- ++({\openLegLength*cos(\angleM)}, {\openLegLength*sin(\angleM)}) -- ({\posXNE+\openLegLength*cos(\angleEa)}, {\posYNE+\openLegLength*sin(\angleEa)}) -- (NE);
		\draw[virtualLegWithoutArrows] (NpL) -- ++({\openLegLength*cos(\angleL)}, {\openLegLength*sin(\angleL)}) -- ({\posXNE+\openLegLength*cos(\angleEb)}, {\posYNE+\openLegLength*sin(\angleEb)}) -- (NE);
		
	\end{tikzpicture}
\end{document}