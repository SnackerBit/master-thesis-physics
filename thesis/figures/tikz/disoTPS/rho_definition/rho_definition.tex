\documentclass[crop, tikz]{standalone}
\usetikzlibrary{decorations.pathreplacing}
\input{../../style.tex}
\begin{document}
	\def\tensorDistance{\defaultDistanceSmall}
	\def\equationDistance{\defaultDistanceEquations}
	\def\unitaryWidth{0.9*\smallTensorWidth}
	\def\thetaHeight{2.0*\smallTensorWidth}
	\def\unitaryHeight{2.0*\smallTensorWidth}
	\def\horizontalTextOffsetMultiplier{1.5}
	\def\verticalOffsetUnitaries{2.3*\smallTensorWidth}
	\def\thetaUdist{0.8*\smallTensorWidth}
	\def\secondEquationXshift{-\smallTensorWidth/2}
	\begin{tikzpicture}
		
		% ============================================================================
		% 1st part
		% ============================================================================
		
		\node[tensorAuxillary, fill=white, inner sep=0] (rho) at (0, 0) {$\rho$};
		
		\begin{pgfonlayer}{bg}
			\draw[virtualLegSmall, transform canvas={xshift={\defaultLegSeperation*sin(90)/2}, yshift={-\defaultLegSeperation*cos(90)/2}}] (0, \tensorDistance) -- ++(0, -\tensorDistance+\defaultTensorWidth/2);
			\draw[specialLeg, transform canvas={xshift={-\defaultLegSeperation*sin(90)/2}, yshift={\defaultLegSeperation*cos(90)/2}}] (0, \tensorDistance) -- ++(0, -\tensorDistance+\defaultTensorWidth/2);
			
			\draw[virtualLegSmall, transform canvas={xshift={\defaultLegSeperation*sin(90)/2}, yshift={-\defaultLegSeperation*cos(90)/2}}] (0, -\tensorDistance) -- ++(0, \tensorDistance-\defaultTensorWidth/2);
			\draw[specialLeg, transform canvas={xshift={-\defaultLegSeperation*sin(90)/2}, yshift={\defaultLegSeperation*cos(90)/2}}] (0, -\tensorDistance) -- ++(0, \tensorDistance-\defaultTensorWidth/2);
		\end{pgfonlayer}
	
		\node[] () at ({-\horizontalTextOffsetMultiplier*\defaultLegSeperation*sin(90)/2}, \tensorDistance+\defaultTextOffsetLarge) {$l$};
		\node[] () at ({\horizontalTextOffsetMultiplier*\defaultLegSeperation*sin(90)/2}, \tensorDistance+\defaultTextOffsetLarge) {$i$};
		\node[] () at ({-\horizontalTextOffsetMultiplier*\defaultLegSeperation*sin(90)/2}, -\tensorDistance-\defaultTextOffsetLarge) {$l^\prime$};
		\node[] () at ({\horizontalTextOffsetMultiplier*\defaultLegSeperation*sin(90)/2}, -\tensorDistance-\defaultTextOffsetLarge) {$i^\prime$};
		
		% ============================================================================
		% 2nd part
		% ============================================================================
		
		\def\posX{\defaultTensorWidth/2 + \equationDistance + \tensorDistance - \smallTensorWidth/2 + \thetaHeight/2 + \secondEquationXshift}
		
		\node[] at (\defaultTensorWidth/2 + \equationDistance/2, 0) {$=$};
		
		\node[tensorOrthoCenterSmall, ellipse, minimum width=\thetaHeight, minimum height=\smallTensorWidth, fill=white, inner sep=0] (theta) at (\posX, \verticalOffsetUnitaries/2 + \unitaryWidth + \smallTensorWidth/2 + \thetaUdist) {$\theta$};
		
		\node[tensorOperatorSmall, minimum width=\unitaryHeight, minimum height=\unitaryWidth] (U) at (\posX, \verticalOffsetUnitaries/2+\unitaryWidth/2) {};
		\node[] () at (\posX+\unitaryHeight/2+\defaultTextOffsetLarge, \verticalOffsetUnitaries/2+\unitaryWidth/2) {$U$};Â¸
		
		\node[tensorOperatorSmall, minimum width=\unitaryHeight, minimum height=\unitaryWidth] (Uc) at (\posX, -\verticalOffsetUnitaries/2-\unitaryWidth/2) {};
		\node[] () at (\posX+\unitaryHeight/2+\defaultTextOffsetLarge, -\verticalOffsetUnitaries/2-\unitaryWidth/2) {$U^*$};
		
		\node[tensorOrthoCenterSmall, ellipse, minimum width=\thetaHeight, minimum height=\smallTensorWidth, fill=white, inner sep=0] (thetac) at (\posX, -\verticalOffsetUnitaries/2 - \unitaryWidth - \smallTensorWidth/2 - \thetaUdist) {$\theta^*$};
		
		\begin{pgfonlayer}{bg}
			\draw[specialLeg] (theta)+(-\tensorDistance-\thetaHeight/2+\smallTensorWidth, 0) -- (theta);
			\draw[specialLeg] (thetac)+(-\tensorDistance-\thetaHeight/2+\smallTensorWidth, 0) -- (thetac);
			\draw[specialLeg] (theta)+(\tensorDistance+\thetaHeight/2-\smallTensorWidth, 0) -- (theta);
			\draw[specialLeg] (thetac)+(\tensorDistance+\thetaHeight/2-\smallTensorWidth, 0) -- (thetac);
			
			\draw[specialLegWithoutArrows] (theta) -- ++(\tensorDistance+\thetaHeight/2-\smallTensorWidth, 0) -- (\posX+\tensorDistance+\thetaHeight/2-\smallTensorWidth, -\verticalOffsetUnitaries/2 - \unitaryWidth - \smallTensorWidth/2 - \thetaUdist) -- (thetac);
			
			
			\draw[virtualLegSmall, transform canvas={xshift={\defaultLegSeperationLarge*sin(90)/2}, yshift={-\defaultLegSeperationLarge*cos(90)/2}}] (U.center) -- (theta.center);
			\draw[virtualLegSmall, transform canvas={xshift={-\defaultLegSeperationLarge*sin(90)/2}, yshift={\defaultLegSeperationLarge*cos(90)/2}}] (U.center) -- (theta.center);
			\draw[virtualLegSmall, transform canvas={xshift={\defaultLegSeperationLarge*sin(90)/2}, yshift={-\defaultLegSeperationLarge*cos(90)/2}}] (Uc.center) -- (thetac.center);
			\draw[virtualLegSmall, transform canvas={xshift={-\defaultLegSeperationLarge*sin(90)/2}, yshift={\defaultLegSeperationLarge*cos(90)/2}}] (Uc.center) -- (thetac.center);
			
			\draw[virtualLegSmall, transform canvas={xshift={\defaultLegSeperationLarge*sin(90)/2}, yshift={\defaultLegSeperationLarge*cos(90)/2}}] (\posX, \verticalOffsetUnitaries/2-\thetaUdist) -- (U);
			\draw[virtualLegSmall, transform canvas={xshift={-\defaultLegSeperationLarge*sin(90)/2}, yshift={\defaultLegSeperationLarge*cos(90)/2}}] (\posX, \verticalOffsetUnitaries/2-\thetaUdist) -- (U);
			\draw[virtualLegSmall, transform canvas={xshift={\defaultLegSeperationLarge*sin(90)/2}, yshift={\defaultLegSeperationLarge*cos(90)/2}}] (\posX, -\verticalOffsetUnitaries/2+\thetaUdist) -- (Uc);
			\draw[virtualLegSmall, transform canvas={xshift={-\defaultLegSeperationLarge*sin(90)/2}, yshift={\defaultLegSeperationLarge*cos(90)/2}}] (\posX, -\verticalOffsetUnitaries/2+\thetaUdist) -- (Uc);
		
			\draw[virtualLegSmallWithoutArrows, transform canvas={xshift={\defaultLegSeperationLarge*sin(90)/2}, yshift={\defaultLegSeperationLarge*cos(90)/2}}] (U) -- (Uc);	
		\end{pgfonlayer}
	
		
		\node[] () at (\posX-\tensorDistance-\thetaHeight/2+\smallTensorWidth-\defaultTextOffset, \verticalOffsetUnitaries/2 + \unitaryWidth + \smallTensorWidth/2 + \thetaUdist) {$l$};
		\node[] () at (\posX-\tensorDistance-\thetaHeight/2+\smallTensorWidth-\defaultTextOffset, -\verticalOffsetUnitaries/2 - \unitaryWidth - \smallTensorWidth/2 - \thetaUdist) {$l^\prime$};
		
		\node[] () at (\posX-\defaultLegSeperationLarge/2-\defaultTextOffsetLarge, \verticalOffsetUnitaries/2-\thetaUdist/2-\defaultTextOffsetSmall) {$i$};
		\node[] () at (\posX-\defaultLegSeperationLarge/2-\defaultTextOffsetLarge, -\verticalOffsetUnitaries/2+\thetaUdist/2+\defaultTextOffsetSmall) {$i^\prime$};
		
	\end{tikzpicture}
\end{document}